<div class="vorspann">Mit diesem Artikel schließe ich meine Einführung in die chrono-Erweiterung in C++20 ab. Heute geht es um die Zeitzonenfunktionalität.</div>
<div class="text"><img class="rteInlinetag" src="https://heise-cms.de/thumbs//3/0/0/2/5/9/0/TN_202415377_e4468f2198.png" title="<ir_inline itemname=bilder_mvp_bild_var2:1 type=2>" style="max-height: 25px; max-width: 25px;"><br></div>
<div class="text">Zuerst möchte ich auf Howard Hinnants Online-Quelle "<a alt="%7B%22alias%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fgithub.com%2FHowardHinnant%2Fdate%2Fwiki%2FExamples-and-Recipes%22%2C%22text%22%3A%22Examples%20and%20Recipes%22%2C%22anchor%22%3A%22%22%2C%22custom%22%3A%7B%7D%2C%22target%22%3A%22_blank%22%2C%22ir_link%22%3A1%2C%22destination%22%3A%22https%3A%2F%2Fgithub.com%2FHowardHinnant%2Fdate%2Fwiki%2FExamples-and-Recipes%22%2C%22type%22%3A%22E%22%2C%22version%22%3A1%2C%22subject%22%3A%22%22%7D" class="" href="https://github.com/HowardHinnant/date/wiki/Examples-and-Recipes" title="Link auf https://github.com/HowardHinnant/date/wiki/Examples-and-Recipes">Examples and Recipes</a>" hinweisen, die mehr als 40 Beispiele zur neuen chrono-Funktionalität anbietet. Zugegeben, sie ist nicht einfach zu verstehen; daher ist es umso wichtiger, viele Rezepte studieren zu können. Diese sind ein idealer Startpunkt für weitere Experimente und helfen, das Verständnis der chrono-Erweiterungen zu vertiefen. Es lassen sich auch neue Rezepte hinzufügen.</div>
<div class="ztitel">Das Ordinaldatum berechnen</div>
<div class="text">Um einen kleinen Einblick in die Beispiele und Rezepte zu erhalten, möchte ich ein Programm von Roland Bock vorstellen, das das Ordinaldatum (ordinal date) berechnet.<br></div>
<div class="einrueckung">"An ordinal date consists of a year and a day of year (1st of January being day 1, 31st of December being day 365 or day 366). The year can be obtained directly from year_month_day. And calculating the day is wonderfully easy. In the code below we make us of the fact that year_month_day can deal with invalid dates like the 0th of January:" (Roland Bock)</div>
<div class="text">Ich habe die notwendigen Header-Dateien zum Programm hinzugefügt:<br></div>
<div class="pre">// ordinalDate.cpp<br><br>#include "date.h"<br>#include &lt;iomanip&gt;<br>#include &lt;iostream&gt;<br><br>int main()<br>{<br>&nbsp;&nbsp; using namespace date;<br>&nbsp; &nbsp;<br>&nbsp;&nbsp; const auto time = std::chrono::system_clock::now();<br>&nbsp;&nbsp; const auto daypoint = floor&lt;days&gt;(time);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (1) <br>&nbsp;&nbsp; const auto ymd = year_month_day{daypoint};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp; &nbsp;<br>&nbsp;&nbsp; // calculating the year and the day of the year<br>&nbsp;&nbsp; const auto year = ymd.year();<br>&nbsp;&nbsp; const auto year_day = daypoint - sys_days{year/January/0}; // (2) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (3)<br>&nbsp;&nbsp; std::cout &lt;&lt; year &lt;&lt; '-' &lt;&lt; std::setfill('0') &lt;&lt; std::setw(3) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; year_day.count() &lt;&lt; std::endl;<br>&nbsp; &nbsp;<br>&nbsp;&nbsp; // inverse calculation and check<br>&nbsp;&nbsp; assert(ymd == year_month_day{sys_days{year/January/0} + year_day});<br>}</div>
<div class="text">Ich möchte das Programm um ein paar Bemerkungen ergänzen. Zeile (1) reduziert den gegenwärtigen Zeitpunkt auf die Tagesauflösung. Der Wert wird in der folgenden Zeile zum Initialisieren eines Kalenderdatums verwendet. Zeile (2) berechnet die Zeitdauer zwischen den zwei Zeitpunkten. Beide besitzen eine Tagesauflösung. Zum Abschluss gibt <span class="tx_code">year_day.count()</span> in Zeile (3) die Zeitdauer in Tagen zurück.</div>
<div class="text"><img class="rteInlinetag" src="https://heise-cms.de/thumbs//3/0/0/2/5/9/0/TN_202415389_8abe0a9f54.png" title="<ir_inline itemname=bilder_mvp_bild_var2:3 type=2>" style="max-height: 25px; max-width: 25px;"><br></div>
<div class="text">Die Ideen für meine weiteren Beispiele gehen auf die genannten "<a alt="%7B%22anchor%22%3A%22%22%2C%22text%22%3A%22Examples%20and%20Recipes%22%2C%22user_params%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fgithub.com%2FHowardHinnant%2Fdate%2Fwiki%2FExamples-and-Recipes%22%2C%22alias%22%3A%22%22%2C%22destination%22%3A%22https%3A%2F%2Fgithub.com%2FHowardHinnant%2Fdate%2Fwiki%2FExamples-and-Recipes%22%2C%22ir_link%22%3A1%2C%22target%22%3A%22_blank%22%2C%22custom%22%3A%7B%7D%2C%22subject%22%3A%22%22%2C%22version%22%3A1%2C%22type%22%3A%22E%22%7D" class="" title="Link auf https://github.com/HowardHinnant/date/wiki/Examples-and-Recipes" href="https://github.com/HowardHinnant/date/wiki/Examples-and-Recipes">Examples and Recipes</a>" zurück.</div>
<div class="ztitel">Zeitzonen<br></div>
<div class="text">Zuerst einmal ist eine Zeitzone eine Region und ihre vollständige Geschichte zu Sommerzeiten und Schaltjahren. Die Zeitzonen-Bibliothek in C++20 ist ein vollständiger Parser für die <a alt="%7B%22target%22%3A%22_blank%22%2C%22ir_link%22%3A1%2C%22destination%22%3A%22https%3A%2F%2Fwww.iana.org%2Ftime-zones%22%2C%22custom%22%3A%7B%7D%2C%22version%22%3A1%2C%22subject%22%3A%22%22%2C%22type%22%3A%22E%22%2C%22user_params%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fwww.iana.org%2Ftime-zones%22%2C%22text%22%3A%22IANA-Zeitzonen-Datenbank%22%2C%22anchor%22%3A%22%22%2C%22alias%22%3A%22%22%7D" href="https://www.iana.org/time-zones" title="Link auf https://www.iana.org/time-zones" class="">IANA-Zeitzonen-Datenbank</a>. Die folgende Tabelle gibt eine erste Idee der neuen Funktionalität.<br></div>
<div class="text"><img class="rteInlinetag" src="https://heise-cms.de/thumbs//3/0/0/2/5/9/0/TN_202415391_684c0eb4b5.png" title="<ir_inline itemname=bilder_mvp_bild_var2:4 type=2>" style="max-height: 25px; max-width: 25px;"><br></div>
<div class="text">Ich verwende in meinen Beispielen die Funktion <span class="tx_code">std::chrono::zones_time</span>, die im Wesentlichen eine Zeitzone mit einem Zeitpunkt kombiniert darstellt.</div>
<div class="text">Bevor ich zwei Beispiele vorstelle, möchte ich noch einen kleine Bemerkung loswerden. Um die Zeitzonenfunktionalität zu verwenden, muss die Datei <span class="tx_code">tz.cpp</span> übersetzt und gegen die <a title="Link auf https://curl.se/" href="https://curl.se/" class="" alt="%7B%22alias%22%3A%22%22%2C%22anchor%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fcurl.se%2F%22%2C%22text%22%3A%22curl%22%2C%22custom%22%3A%7B%7D%2C%22destination%22%3A%22https%3A%2F%2Fcurl.se%2F%22%2C%22target%22%3A%22_blank%22%2C%22ir_link%22%3A1%2C%22type%22%3A%22E%22%2C%22subject%22%3A%22%22%2C%22version%22%3A1%7D">curl</a>-Bibliothek gelinkt werden. Die Bibliothek ist für den Zugriff auf die IANA-Zeitzonen-Datenbank notwendig. Die folgende Kommandozeile mit dem g++ fasst alle Informationen zusammen:</div>
<div class="pre">g++ localTime.cpp -I &lt;Path to data/tz.h&gt; tz.cpp -std=c++17 -lcurl -o localTime</div>
<div class="text">Mein erstes Programm ist denkbar einfach und stellt sowohl die UTC- als auch die lokale Zeit dar.</div>
<div class="ztitel">UTC- und lokale Zeit<br></div>
<div class="text">Die <a href="https://de.wikipedia.org/wiki/Koordinierte_Weltzeit" title="Link auf https://de.wikipedia.org/wiki/Koordinierte_Weltzeit" class="" alt="%7B%22alias%22%3A%22%22%2C%22anchor%22%3A%22%22%2C%22text%22%3A%22UTC%20oder%20koordinierte%20Weltzeit%22%2C%22user_params%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fde.wikipedia.org%2Fwiki%2FKoordinierte_Weltzeit%22%2C%22custom%22%3A%7B%7D%2C%22destination%22%3A%22https%3A%2F%2Fde.wikipedia.org%2Fwiki%2FKoordinierte_Weltzeit%22%2C%22ir_link%22%3A1%2C%22target%22%3A%22_blank%22%2C%22type%22%3A%22E%22%2C%22subject%22%3A%22%22%2C%22version%22%3A1%7D">UTC oder koordinierte Weltzeit</a> ist der Zeitstandard weltweit. Ein Computer verwendet die <a class="" href="https://de.wikipedia.org/wiki/Unixzeit" title="Link auf https://de.wikipedia.org/wiki/Unixzeit" alt="%7B%22alias%22%3A%22%22%2C%22text%22%3A%22Unixzeit%22%2C%22user_params%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fde.wikipedia.org%2Fwiki%2FUnixzeit%22%2C%22anchor%22%3A%22%22%2C%22custom%22%3A%7B%7D%2C%22ir_link%22%3A1%2C%22target%22%3A%22_blank%22%2C%22destination%22%3A%22https%3A%2F%2Fde.wikipedia.org%2Fwiki%2FUnixzeit%22%2C%22type%22%3A%22E%22%2C%22version%22%3A1%2C%22subject%22%3A%22%22%7D">Unixzeit</a>, die eine genaue Näherung der UTC ist. Die <a alt="%7B%22type%22%3A%22E%22%2C%22version%22%3A1%2C%22subject%22%3A%22%22%2C%22custom%22%3A%7B%7D%2C%22target%22%3A%22_blank%22%2C%22ir_link%22%3A1%2C%22destination%22%3A%22https%3A%2F%2Fde.wikipedia.org%2Fwiki%2FUnixzeit%22%2C%22alias%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fde.wikipedia.org%2Fwiki%2FUnixzeit%22%2C%22user_params%22%3A%22%22%2C%22text%22%3A%22Unixzeit%22%2C%22anchor%22%3A%22%22%7D" class="" href="https://de.wikipedia.org/wiki/Unixzeit" title="Link auf https://de.wikipedia.org/wiki/Unixzeit">Unixzeit</a> ist die Anzahl der Sekunden seit der Unix-Epoche. Die Unix-Epoche beginnt mit dem Zeitpunkt 00:00:00 UTC am 1. Januar 1970.</div>
<div class="text"><span class="tx_code">std::chrono::system_clock::now()</span> in Zeile (1) gibt in dem folgenden Programm <span class="tx_code">localTime.cpp</span>&nbsp;die Unixzeit zurück: </div>
<div class="pre">// localTime.cpp<br><br>#include "date/tz.h"<br>#include &lt;iostream&gt;<br><br>int main() {<br><br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; std::endl;<br><br>&nbsp;&nbsp;&nbsp; using namespace date;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "UTC&nbsp; time" &lt;&lt; std::endl;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (1)<br>&nbsp;&nbsp;&nbsp; auto utcTime = std::chrono::system_clock::now();<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "&nbsp; " &lt;&lt; utcTime &lt;&lt; std::endl;<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "&nbsp; " &lt;&lt; date::floor&lt;std::chrono::seconds&gt;(utcTime) &lt;&lt; '\n':<br><br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; std::endl;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "Local time" &lt;&lt; std::endl;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (2)<br>&nbsp;&nbsp;&nbsp; auto localTime = date::make_zoned(date::current_zone(), utcTime);<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "&nbsp; " &lt;&lt; localTime &lt;&lt; std::endl;<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "&nbsp; " &lt;&lt; date::floor&lt;std::chrono::seconds&gt;(localTime.get_local_time()) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; std::endl;<br><br>&nbsp;&nbsp;&nbsp; auto offset = localTime.get_info().offset;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (3)<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "&nbsp; UTC offset: "&nbsp; &lt;&lt; offset &lt;&lt; std::endl;<br><br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; std::endl;<br><br>}</div>
<div class="text">Ich habe dem Programm nicht allzu viel hinzuzufügen. Der Codebereich, beginnend mit der Zeile (1), erhält den gegenwärtige Zeitpunkt, schneidet ihn auf Sekunden ab und stellt ihn dar. <span class="tx_code">date::make_zoned</span> erzeugt <span class="tx_code">std::chrono::zoned_time localTime</span>. Der anschließende Funktionsaufruf<span class="tx_code"> localTime.get_local_time()</span> gibt die gespeicherte Zeit in der lokalen Zeit zurück. Dieser Zeitpunkt besitzt auch eine Sekundenauflösung. <span class="tx_code">localTime</span> (Zeile 3) lässt sich dazu verwenden, Informationen über die Zeitzone zu erhalten. In diesem Fall interessiert mich die Differenz zur UTC-Zeit.</div>
<div class="text"><img class="rteInlinetag" src="https://heise-cms.de/thumbs//3/0/0/2/5/9/0/TN_202415400_2ee152f48b.png" title="<ir_inline itemname=bilder_mvp_bild_var2:5 type=2>" style="max-height: 25px; max-width: 25px;"><br></div>
<div class="text">Mein nächstes Programm beantwortet mir die entscheidende Frage, wenn ich eine Schulung in verschiedenen Zeitzonen halte: Wann soll ich mit der Online-Schulung beginnen? <br></div>
<div class="ztitel">Verschiedene Zeitzonen für Online-Schulungen<br></div>
<div class="text">Das Programm <span class="tx_code">onlineClass.cpp</span> stellt die folgenden Informationen dar: Wie spät ist es in einer gegebenen Zeitzone, wenn ich die Online-Schulung um <span class="tx_code">7h</span>, <span class="tx_code">13h</span> oder <span class="tx_code">17h</span> in meiner lokalen Zeit (Deutschland) beginne?<br></div>
<div class="pre">// onlineClass.cpp<br><br>#include "date/tz.h"<br>#include &lt;algorithm&gt;<br>#include &lt;iomanip&gt;<br>#include &lt;iostream&gt;<br><br>template &lt;typename ZonedTime&gt;<br>auto getMinutes(const ZonedTime&amp; zonedTime) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (1)<br>&nbsp;&nbsp;&nbsp; return date::floor&lt;std::chrono::minutes&gt;(zonedTime.get_local_time());<br>}<br><br>void printStartEndTimes(const date::local_days&amp; localDay,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const std::chrono::hours&amp; h, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const std::chrono::hours&amp; durationClass,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const std::initializer_list&lt;std::string&gt;&amp; timeZones ){<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp; date::zoned_time startDate{date::current_zone(), localDay + h};&nbsp; // (4)<br>&nbsp;&nbsp;&nbsp; date::zoned_time endDate{date::current_zone(), localDay + h + durationClass};<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "Local time: ["&nbsp; &lt;&lt; getMinutes(startDate) &lt;&lt; ", " <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; getMinutes(endDate) &lt;&lt; "]" &lt;&lt; std::endl;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (5)<br>&nbsp;&nbsp; &nbsp;longestStringSize = std::max(timeZones, [](const std::string&amp; a, const std::string&amp; b) { return a.size() &lt; b.size(); }).size();<br>&nbsp;&nbsp;&nbsp; for (auto timeZone: timeZones) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; "&nbsp; " &lt;&lt; std::setw(longestStringSize + 1) &lt;&lt; std::left <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; timeZone <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; "[" &lt;&lt; getMinutes(date::zoned_time(timeZone, startDate))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; ", " &lt;&lt; getMinutes(date::zoned_time(timeZone, endDate)) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt; "]" &lt;&lt; std::endl;<br><br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;}<br><br>int main() {<br><br>&nbsp;&nbsp;&nbsp; using namespace std::string_literals;<br>&nbsp;&nbsp;&nbsp; using namespace std::chrono;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; std::endl;<br><br>&nbsp;&nbsp;&nbsp; constexpr auto classDay{date::year(2021)/2/1};<br>&nbsp;&nbsp;&nbsp; constexpr auto durationClass = 4h;<br>&nbsp;&nbsp;&nbsp; auto timeZones = {"America/Los_Angeles"s, "America/Denver"s, "America/New_York"s, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Europe/London"s, "Europe/Minsk"s, "Europe/Moscow"s, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Asia/Kolkata"s, "Asia/Novosibirsk"s, "Asia/Singapore"s,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Australia/Perth"s, "Australia/Sydney"s};<br><br>&nbsp;&nbsp;&nbsp; for (auto startTime: {7h, 13h, 17h}) {&nbsp;&nbsp;&nbsp; // (3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printStartEndTimes(date::local_days{classDay}, startTime, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; durationClass, timeZones);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; std::cout &lt;&lt; std::endl;<br>&nbsp;&nbsp;&nbsp; }<br><br>}</div>
<div class="text">Bevor ich mich mit den Funktionen <span class="tx_code">getMinutes</span> (Zeile 1) und <span class="tx_code">printStartEndTimes</span> (Zeile 2) beschäftige, stelle ich die <span class="tx_code">main-</span>Funktion vor. Sie definiert den Tag, die Dauer und die Zeitzone der Online-Schulung. Anschließend iteriert die Range-basierte for-Schleife durch alle Startpunkte für Online-Schulungen. Dank der Funktion <span class="tx_code">printStartEndTimes</span> (Zeile 3) werden alle wichtigen Informationen dargestellt.</div>
<div class="text">Die Zeilen beginnend mit (4) berechnen den <span class="tx_code">startDate</span> und den <span class="tx_code">endDate</span> meiner Online-Schulung, indem die Zeitdauer auf den Startzeitpunkt addiert wird. Beide Werte stellt die Funktion <span class="tx_code">getMinutes</span> (Zeile 1) dar.<span class="tx_code"> date::floor&lt;std::chrono::minutes&gt;(zonedTime.get_local_time())</span> erhält den gespeicherten Zeitpunkt aus <span class="tx_code">std::chrono::zoned_time</span> und reduziert ihn auf seine Minutenauflösung. Um die Werte richtig auszurichten, bestimmt Zeile (5) die Länge des längsten Namens der verschieden Zeitzonen. Zeile (6) iteriert durch alle Zeitzonen, stellt den Namen der Zeitzone sowie den Start- und Endzeitpunkt der Online-Schulung dar. Einige Kalenderdaten überschreiten die Tagesgrenze.</div>
<div class="text"><img class="rteInlinetag" src="https://heise-cms.de/thumbs//3/0/0/2/5/9/0/TN_202415405_2a4b9c4992.png" title="<ir_inline itemname=bilder_mvp_bild_var2:6 type=2>" style="max-height: 25px; max-width: 25px;"><br></div>
<div class="text">Es gibt sicherlich mehr zur erweiterten chrono-Bibliothek zu schreiben. So bietet C++20 zum Beispiel den neuen Zeiger <span class="tx_code">std::chrono::utc_clock</span> an. Dieser berücksichtigt Schaltsekunden. Der weitere Zeitgeber <span class="tx_code">std::chrono::tai_clock</span> steht für die internationale Atomzeit (TAI). Zusätzlich lassen sich Zeitdauern mit der neuen Formatierungsbibliothek schön formatiert ausgeben. Dieses Feature steht aber noch nicht zur Verfügung. Wenn du die Formatierungsregeln bereits studieren willst, hier sind sie: <span class="tx_code"><a alt="%7B%22type%22%3A%22E%22%2C%22version%22%3A1%2C%22subject%22%3A%22%22%2C%22custom%22%3A%7B%7D%2C%22target%22%3A%22_blank%22%2C%22ir_link%22%3A1%2C%22destination%22%3A%22https%3A%2F%2Fen.cppreference.com%2Fw%2Fcpp%2Fchrono%2Fsystem_clock%2Fformatter%23Format_specification%22%2C%22alias%22%3A%22%22%2C%22href%22%3A%22https%3A%2F%2Fen.cppreference.com%2Fw%2Fcpp%2Fchrono%2Fsystem_clock%2Fformatter%23Format_specification%22%2C%22user_params%22%3A%22%22%2C%22text%22%3A%22std%3A%3Aformatter%22%2C%22anchor%22%3A%22%22%7D" href="https://en.cppreference.com/w/cpp/chrono/system_clock/formatter#Format_specification" title="Link auf https://en.cppreference.com/w/cpp/chrono/system_clock/formatter#Format_specification" class="">std::formatter</a></span>. <br></div>
<div class="ztitel">Wie geht's weiter?</div>
<div class="text">Werden Ganzahlen mit und ohne Vorzeichen verglichen, führt dies oft zu Überraschungen. Diese Überraschungen enden mit C++20.<br></div>