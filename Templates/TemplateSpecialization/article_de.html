<div class="vorspann">Templates definieren das Verhalten von Familien von Klassen oder Funktionen. Oft ist es erforderlich, spezielle Typen oder Nicht-Typen besonders zu behandeln. Um diesen Anwendungsfall zu erfüllen, kannst du Templates spezialisieren.</div>
<div class="text"><img class="rteInlinetag" src="https://heise-cms.de/thumbs//3/1/2/9/4/8/3/TN_213044580_679650254f.png" title="<ir_inline itemname=bilder_mvp_bild_var2:1 type=2>" style="max-height: 25px; max-width: 25px;"><br></div>
<div class="text">Zunächst möchte ich die allgemeine Idee hinter der Template-Spezialisierung beleuchten. Im nächsten Artikel konzentriere ich mich auf die Details.</div>
<div class="ztitel">Template-Spezialisierung</div>
<div class="text">Templates definieren das Verhalten von Familien von Klassen und Funktionen. Oft ist es erforderlich, spezielle Typen oder Nicht-Typen besonders zu behandeln. Dazu kannst du Templates vollständig spezialisieren.</div>
<div class="text">Klassen-Templates lassen sich auch teilweise spezialisieren. Das allgemeine oder primäre Template kann mit teilweise oder vollständig spezialisierten Templates koexistieren. Die Memberfunktionen und Attribute einer Spezialisierung müssen nicht identisch mit denen des primären Templates sein. Der Compiler bevorzugt vollständig spezialisierte gegenüber teilweise spezialisierten Templates, und teilweise spezialisierte Templates gegenüber primären Templates.</div>
<div class="text">Das folgende Beispiel soll meine Worte verdeutlichen:</div>
<div class="pre">template &lt;typename T, int Line, int Column&gt; // (1)<br>class Matrix;<br><br>template &lt;typename T&gt; // (2)<br>class Matrix&lt;T, 3, 3&gt;{};<br><br>template &lt;&gt; // (3)<br>class Matrix&lt;int, 3, 3&gt;{};</div>
<div class="text"><ul><li><b>Primäre Templates</b></li></ul></div>
<div class="text">Zeile 1 beschreibt das primäre oder allgemeine Template. Das primäre Template muss vor den teilweise oder vollständig spezialisierten Templates deklariert werden. Wird das primäre Template nicht benötigt, ist eine Deklaration wie in Zeile 1 in Ordnung.</div>
<div class="text"><ul><li><b>Partielle Spezialisierung</b></li></ul></div>
<div class="text">In Zeile 2 folgt die partielle Spezialisierung. Nur Klassen-Templates unterstützen partielle Spezialisierung. Eine partielle Spezialisierung hat Template-Parameter und explizit angegebene Template-Argumente. Im konkreten Fall der Klasse <span class="tx_code">Matrix&lt;T, 3, 3&gt;</span>&nbsp; ist<span class="tx_code"> T</span> der Template-Parameter und die Zahlen sind die Template-Argumente.</div>
<div class="text"><ul><li><b>Vollständige Spezialisierung</b></li></ul></div>
<div class="text">Zeile 3 zeigt eine vollständige Spezialisierung. Vollständig bedeutet, dass alle Template-Argumente angegeben sind und die Template-Parameterliste leer ist:<span class="tx_code"> template &lt;&gt;</span> in Zeile 3.</div>
<div class="ztitel_kleiner">Partielle versus vollständige Spezialisierung</div>
<div class="text">Um die partielle und vollständige Spezialisierung besser zu verstehen, möchte ich eine visuelle Erklärung präsentieren. Du weißt vielleicht, dass ich Mathematik studiert habe und viele lineare Gleichungssysteme zu lösen hatte.</div>
<div class="text">Denke an einen n-dimensionalen Raum von Template-Parametern. Eine partielle Spezialisierung ist ein Unterraum im n-dimensionalen Raum, und eine vollständige Spezialisierung ist ein Punkt im n-dimensionalen Raum.</div>
<div class="text">Nun wende ich meine visuelle Erklärung auf das Klassen-Template <span class="tx_code">Matrix</span> und ihre partielle und vollständige Spezialisierung an. In dem primären Template (Zeile 1) kannst du einen Typ als Template-Parameter und zwei int-Werte als Nicht-Typ-Template-Parameter wählen. Bei der partiellen Spezialisierung in Zeile 2 lässt sich nur der Typ auswählen. Das bedeutet, dass der 3-dimensionale Raum auf eine Linie reduziert wird. Die partielle Spezialisierung des primären Templates <span class="tx_code">Matrix</span> ist somit ein Unterraum des 3-dimensionalen Raumes. Die volle Spezialisierung (Zeile 3) steht für einen Punkt im 3-dimensionalen Raum. </div>
<div class="text">Was passiert, wenn du das Template verwendest?</div>
<div class="ztitel_kleiner">Verwendung der primären, partiellen und vollständigen Spezialisierung</div>
<div class="text">Zur Erinnerung: Die folgenden Spezialisierungen der Klasse Matrix sind gegeben:</div>
<div class="pre">template &lt;typename T, int Line, int Column&gt; // (1)<br>class Matrix;<br><br>template &lt;typename T&gt; // (2)<br>class Matrix&lt;T, 3, 3&gt;{};<br><br>template &lt;&gt; // (3)<br>class Matrix&lt;int, 3, 3&gt;{};</div>
<div class="text">Die Frage ist: Was passiert, wenn du Matrix für verschiedene Template-Argumente instanziierst? Das folgende Beispiel zeigt drei Instanziierungen und deren Umsetzung durch den Compiler:</div>
<div class="pre">Matrix&lt;int, 3, 3&gt; m1; // class Matrix&lt;int, 3, 3&gt;<br><br>Matrix&lt;double, 3, 3&gt; m2; // class Matrix&lt;T, 3, 3&gt; <br><br>Matrix&lt;std::string, 4, 3&gt; m3; // class Matrix&lt;T, Line, Column&gt; =&gt; ERROR</div>
<div class="text"><span class="tx_code">m1</span> verwendet die vollständige Spezialisierung, <span class="tx_code">m2</span> die partielle Spezialisierung und <span class="tx_code">m3</span> das primäre Template. Da die Definition fehlt, verursacht die Verwendung von<span class="tx_code"> m3</span> einen Fehler.</div>
<div class="text">Um diesen Prozess zu verstehen, musst du ein paar Regeln im Hinterkopf behalten. Die folgenden Regeln gelten insbesondere für die partielle Spezialisierung von Klassen-Templates:</div>
<div class="text"><ul><li><b>Abhängigkeiten zwischen dem Template-Parameter und den Template-Argumenten</b><br></li></ul></div>
<div class="text"><ul><ul><li>Die Anzahl und Reihenfolge der explizit angegebenen Template-Argumente (<span class="tx_code">&lt;T, 3, 3&gt;</span>) muss mit der Anzahl und Reihenfolge der Template-Parameterliste <span class="tx_code">(&lt;typename T, int Line, int Column&gt;</span>) des primären Templates übereinstimmen.</li><li>Wenn du Standardwerte für Template-Parameter verwendest, brauchst du die Template-Argumente nicht anzugeben. Nur das primäre Template akzeptiert Defaultwerte für Template-Parameter.</li></ul></ul></div>
<div class="text"><ul><li><b>Gültige partielle Spezialisierungen</b></li></ul></div>
<div class="text"><ul><ul><li>Der Compiler wählt eine partielle Spezialisierung, wenn die Argumente der Template-Instanziierung (<span class="tx_code">Matrix&lt;double, 3, 3&gt;</span>) eine Teilmenge der Template-Argumente der partiellen Spezialisierung <span class="tx_code">(Matrix&lt;T, 3, 3&gt;</span>) sind.</li></ul></ul></div>
<div class="text"><ul><li><b>Verwendete Template-Spezialisierung</b></li></ul></div>
<div class="text"><ul><ul><li>Der Compiler findet nur eine Spezialisierung. Er verwendet diese Spezialisierung.</li><li>Der Compiler findet mehr als eine Spezialisierung. Er verwendet die am meisten spezialisierte. Wenn dieser Prozess in mehr als einer Spezialisierung endet, wirft der Compiler einen Fehler.</li><li>Der Compiler findet keine Spezialisierung. Er verwendet die primäre Spezialisierung.</li></ul></ul></div>
<div class="text">Okay, eine Frage muss ich noch beantworten. Was bedeutet es, dass ein Template A ein spezialisierteres Template ist als ein spezialisiertes Template B. Meine informelle Definition lautet wie folgt:</div>
<div class="text">Ein Template A ist spezialisierter als ein Template B:</div>
<div class="text"><ul><li>Das Template B kann alle Argumente akzeptieren, die Template A akzeptieren kann.</li><li>Das Template B kann Argumente akzeptieren, die Template A nicht akzeptieren kann.</li></ul></div>
<div class="text">Wenn du es formaler haben willst, besuche <a title="Link auf https://en.cppreference.com/w/cpp/language/partial_specialization" alt="%7B%22target%22%3A%22_blank%22%2C%22subject%22%3A%22%22%2C%22ir_link%22%3A1%2C%22custom%22%3A%7B%7D%2C%22text%22%3A%22cppreference.com%2Fpartial_specialization%22%2C%22mediasync_id%22%3A%22%22%2C%22type%22%3A%22E%22%2C%22anchor%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22alias%22%3A%22%22%2C%22version%22%3A1%2C%22destination%22%3A%22https%3A%2F%2Fen.cppreference.com%2Fw%2Fcpp%2Flanguage%2Fpartial_specialization%22%2C%22href%22%3A%22https%3A%2F%2Fen.cppreference.com%2Fw%2Fcpp%2Flanguage%2Fpartial_specialization%22%7D" href="https://en.cppreference.com/w/cpp/language/partial_specialization" class="">cppreference.com/partial_specialization</a> und lies den Unterabschnitt über partial ordering.<br></div>
<div class="ztitel">Wie geht's weiter?</div>
<div class="text">Dieser Artikel sollte dir die Grundlagen zur Template-Spezialisierung vermitteln, aber wie immer gibt es in C++ mehr Details dazu. Zum Beispiel verhält sich partielle oder vollständige Spezialisierung wie ein <span class="tx_code">if</span> zur Compilezeit und vollständige Spezialisierung von Klassen- oder Funktions-Templates sind den normalen Klassen oder Funktionen sehr ähnlich.</div>
<div class="ztitel">C++ Seminare</div>
<div class="text">Im nächsten halben Jahr biete ich die folgenden Seminare an. Falls es die Covid-19 Situation zulässt, werde ich die Seminare nach Rücksprache als Präsenzseminare durchführen.</div>
<div class="text"><ul><li> <a title="Link auf https://www.modernescpp.de/index.php/c/2-c/32-c-20" alt="%7B%22href%22%3A%22https%3A%2F%2Fwww.modernescpp.de%2Findex.php%2Fc%2F2-c%2F32-c-20%22%2C%22destination%22%3A%22https%3A%2F%2Fwww.modernescpp.de%2Findex.php%2Fc%2F2-c%2F32-c-20%22%2C%22version%22%3A1%2C%22alias%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22anchor%22%3A%22%22%2C%22type%22%3A%22E%22%2C%22mediasync_id%22%3A%22%22%2C%22text%22%3A%22C%2B%2B20%22%2C%22custom%22%3A%7B%7D%2C%22ir_link%22%3A1%2C%22subject%22%3A%22%22%2C%22target%22%3A%22_blank%22%7D" href="https://www.modernescpp.de/index.php/c/2-c/32-c-20" class="">C++20</a>: 10.08.2021 - 12.08.2021 (Termingarantie)<br></li><li> <a title="Link auf https://www.modernescpp.de/index.php/c/2-c/33-embedded-programmierung-mit-modernem-c20210421085111" alt="%7B%22href%22%3A%22https%3A%2F%2Fwww.modernescpp.de%2Findex.php%2Fc%2F2-c%2F33-embedded-programmierung-mit-modernem-c20210421085111%22%2C%22destination%22%3A%22https%3A%2F%2Fwww.modernescpp.de%2Findex.php%2Fc%2F2-c%2F33-embedded-programmierung-mit-modernem-c20210421085111%22%2C%22version%22%3A1%2C%22user_params%22%3A%22%22%2C%22alias%22%3A%22%22%2C%22anchor%22%3A%22%22%2C%22type%22%3A%22E%22%2C%22mediasync_id%22%3A%22%22%2C%22text%22%3A%22Embedded%20Programmierung%20mit%20modernem%20C%2B%2B%22%2C%22custom%22%3A%7B%7D%2C%22ir_link%22%3A1%2C%22target%22%3A%22_blank%22%2C%22subject%22%3A%22%22%7D" href="https://www.modernescpp.de/index.php/c/2-c/33-embedded-programmierung-mit-modernem-c20210421085111" class="">Embedded Programmierung mit modernem C++</a>: 21.09.2021 - 23.09.2021</li><li> <a title="Link auf https://www.modernescpp.de/index.php/c/2-c/34-clean-code-best-practices-fuer-modernes-c" alt="%7B%22href%22%3A%22https%3A%2F%2Fwww.modernescpp.de%2Findex.php%2Fc%2F2-c%2F34-clean-code-best-practices-fuer-modernes-c%22%2C%22destination%22%3A%22https%3A%2F%2Fwww.modernescpp.de%2Findex.php%2Fc%2F2-c%2F34-clean-code-best-practices-fuer-modernes-c%22%2C%22version%22%3A1%2C%22alias%22%3A%22%22%2C%22user_params%22%3A%22%22%2C%22type%22%3A%22E%22%2C%22anchor%22%3A%22%22%2C%22mediasync_id%22%3A%22%22%2C%22text%22%3A%22Clean%20Code%3A%20Best%20Practices%20f%C3%BCr%20modernes%20C%2B%2B%22%2C%22custom%22%3A%7B%7D%2C%22ir_link%22%3A1%2C%22subject%22%3A%22%22%2C%22target%22%3A%22_blank%22%7D" href="https://www.modernescpp.de/index.php/c/2-c/34-clean-code-best-practices-fuer-modernes-c" class="">Clean Code: Best Practices für modernes C++</a>: 14.12.2021 - 16.12.2021<br></li></ul></div>