#include <ios>
#include <iostream>
#include <type_traits>

struct Test {
    template <typename Self>
    void function(this Self&& self, const std::string& text) {
        std::cout << text << ": ";
        std::forward<Self>(self).functionOld();
        std::cout << '\n';
    }

    void functionOld() & {
        std::cout << "non const lvalue";
    }

    void functionOld() const& {
        std::cout << "const lvalue";
    }

    void functionOld() && {
        std::cout << "non const rvalue";
    }

    void functionOld() const&& {
        std::cout << "const rvalue";
    }


};

int main() {

    Test test;
    const Test constTest;

    test.function("test");
    constTest.function("constTest");
    std::move(test).function("std::move(test)");
    std::move(constTest).function("std::move(consTest)");

}